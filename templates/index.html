{% extends "base.html" %}

{% block title %}Excel YÃ¼kle - Admin Panel{% endblock %}

{% block content %}
<div class="card">
    <h1>ğŸš— AraÃ§ Fiyat YÃ¶netimi</h1>
    <p class="subtitle">Excel dosyanÄ±zÄ± yÃ¼kleyin, otomatik olarak iÅŸlensin!</p>
    
    <div class="stats">
        <div class="stat-card">
            <div class="stat-number">{{ total_records }}</div>
            <div class="stat-label">Toplam KayÄ±t</div>
        </div>
    </div>
    
    <form action="/upload" method="post" enctype="multipart/form-data" id="uploadForm">
        <label for="fileInput" class="upload-area">
            <div class="upload-icon">ğŸ“</div>
            <h2>Excel DosyasÄ± YÃ¼kle</h2>
            <p style="margin-top: 10px; color: #666;">
                TÄ±klayÄ±n veya dosyayÄ± sÃ¼rÃ¼kleyin<br>
                <small>(Sadece .xlsx ve .xls)</small>
            </p>
            <input type="file" name="file" id="fileInput" accept=".xlsx,.xls" required>
            <div id="fileName" style="margin-top: 20px; color: #667eea; font-weight: bold;"></div>
        </label>
        
        <div class="action-buttons">
            <button type="submit" class="btn">âœ… YÃ¼kle ve Ä°ÅŸle</button>
            <a href="/view" class="btn btn-secondary">ğŸ“Š Verileri GÃ¶rÃ¼ntÃ¼le</a>
            <button type="button" class="btn btn-danger" onclick="confirmClear()">ğŸ—‘ï¸ TÃ¼mÃ¼nÃ¼ Temizle</button>
        </div>
    </form>
</div>

<form id="clearForm" action="/clear" method="post" style="display: none;"></form>

<script>
    // Dosya seÃ§ildiÄŸinde ismini gÃ¶ster
    document.getElementById('fileInput').addEventListener('change', function(e) {
        const fileName = e.target.files[0]?.name || '';
        document.getElementById('fileName').textContent = fileName ? `SeÃ§ilen: ${fileName}` : '';
    });
    
    // Temizleme onayÄ±
    function confirmClear() {
        if (confirm('âš ï¸ TÃœM VERÄ°LER SÄ°LÄ°NECEK! Emin misiniz?')) {
            document.getElementById('clearForm').submit();
        }
    }
    
    // Drag & Drop desteÄŸi
    const uploadArea = document.querySelector('.upload-area');
    
    uploadArea.addEventListener('dragover', (e) => {
        e.preventDefault();
        uploadArea.style.borderColor = '#764ba2';
        uploadArea.style.background = '#f0f1ff';
    });
    
    uploadArea.addEventListener('dragleave', () => {
        uploadArea.style.borderColor = '#667eea';
        uploadArea.style.background = '#f8f9ff';
    });
    
    uploadArea.addEventListener('drop', (e) => {
        e.preventDefault();
        const file = e.dataTransfer.files[0];
        document.getElementById('fileInput').files = e.dataTransfer.files;
        document.getElementById('fileName').textContent = `SeÃ§ilen: ${file.name}`;
    });
</script>
{% endblock %}